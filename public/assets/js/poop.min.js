"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),poop=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"status";_classCallCheck(this,e),this.statusElId=t}return _createClass(e,[{key:"login",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"login",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"email",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"password";return document.getElementById(e).onclick=function(){var e=document.getElementById(t).value,a=document.getElementById(n).value;firebase.auth().signInWithEmailAndPassword(e,a).catch(function(e){console.error(e.message)})},this}},{key:"listen",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"shit",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"wipe",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"text",a=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"pooper",o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"time",l=firebase.database().ref("shitter/"),s=document.getElementById(e),r=document.getElementById(t),u=document.getElementById(n),c=document.getElementById(i),d=document.getElementById(o);return l.on("value",function(e){u.innerHTML=e.val().text,c.innerHTML=e.val().pooper,d.innerHTML=a.time(e.val().timestamp),!1===e.val().available?(firebase.auth().currentUser.email===document.getElementById("pooper").innerHTML&&(r.disabled=!1),s.disabled=!0,a.close()):(r.disabled=!0,s.disabled=!1,a.open())}),this}},{key:"open",value:function(){this.clear();var e=document.createElement("img");e.src="/assets/images/open.gif",this.status.appendChild(e)}},{key:"close",value:function(){this.clear();var e=document.createElement("img");e.src="/assets/images/closed.jpg",this.status.appendChild(e)}},{key:"clear",value:function(){var e=document.getElementById(this.statusElId);e.innerHTML="",this.status=e}},{key:"time",value:function(e){var t=new Date(e),n=void 0;return n=t.getHours()>12?t.getHours()-12:t.getHours(),t.getFullYear()+"/"+(parseInt(t.getMonth(),10)+1).toString()+"/"+t.getDate()+" "+n+":"+t.getMinutes()+":"+t.getSeconds()}},{key:"main",value:function(e,t,n){firebase.auth().onAuthStateChanged(function(a){if(a){var i=document.getElementById(e),o=document.getElementById(t),l=document.getElementById(n),s=firebase.auth().currentUser.uid,r=firebase.database();i.style.display="none",o.style.display="block",l.onclick=function(){r.ref("poopers/"+s).push({available:!1,timestamp:Date.now(),user:a.email}).then(function(){firebase.database().ref("shitter/").set({available:!1,pooper:a.email,timestamp:Date.now(),text:"current pooper:"})})},document.getElementById("wipe").onclick=function(){r.ref("poopers/"+s).push({available:!0,timestamp:Date.now(),user:a.email}).then(function(){firebase.database().ref("shitter/").set({available:!0,pooper:a.email,timestamp:Date.now(),text:"previous pooooper:"})})}}})}}],[{key:"run",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"login__form",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"gotta_poop",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"shit";return(new e).login().listen().main(t,n,a)}}]),e}();